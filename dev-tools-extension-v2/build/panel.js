!function(e){var t={};function n(s){if(t[s])return t[s].exports;var a=t[s]={i:s,l:!1,exports:{}};return e[s].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(s,a,function(t){return e[t]}.bind(null,a));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){const{toggleRecord:s}=n(1);n(2);const a=chrome.devtools.network,d=document.createElement("div");d.classList.add("wrapper"),document.body.appendChild(d);const i=document.createElement("amedia-event-list");function o(){i.reset()}d.appendChild(i);let c=0;window.addEventListener("message",e=>{if("record"!==e.data.type)return;const t=e.data.payload;var n;i.add(t),"inscreen"==t.payload.type&&"Article"==t.payload.metaType&&(n=t.payload.duration,c+=n,console.log("articleInscreenTotal: ",c),h.innerHTML=`<div>Inscreen-article total: ${c}ms<div>`)});const r=document.createElement("div");r.classList.add("toolbar");const l=document.createElement("div");l.classList.add("recordBtn","active"),l.active=!0;const u=document.createElement("div");u.classList.add("clearBtn");const m=document.createElement("div");m.classList.add("resetCounterBtn");const h=document.createElement("div");h.classList.add("totalDuration"),a.onNavigated.addListener(o),l.addEventListener("click",()=>{l.active=!l.active,l.classList.toggle("active",l.active),s(l.active)}),u.addEventListener("click",()=>o()),m.addEventListener("click",()=>{c=0,h.innerHTML=`<div>Inscreen-article total: ${c}ms<div>`}),r.appendChild(l),r.appendChild(u),r.appendChild(m),r.appendChild(h),document.body.insertBefore(r,d),s(!0)},function(e,t){const n=chrome.devtools.network;function s(e){const{request:t,response:n}=e;if(!function(e){const t=e.url;return"POST"===e.method&&(!!t.includes("adplogger.no")||(!!t.includes("localhost:9677")||!!t.includes("services.localhost.api.no")))}(t)||200!==n.status)return;if(!t.postData.text)return;const s=JSON.parse(t.postData.text);0!==s.length&&s.forEach(e=>window.postMessage({type:"record",payload:e}))}e.exports.toggleRecord=function(e){e?n.onRequestFinished.addListener(s):n.onRequestFinished.removeListener(s)}},function(e,t,n){const{sendMessage:s,addListener:a}=n(3);function d(e,t){const n=document.createElement("dd"),s=t[e];switch(n.textContent=s,e){case"concernsMeta":case"parent":!function(e,t){e.classList.add("link");const n=document.getElementById(t);e.addEventListener("click",()=>{n.click()}),e.addEventListener("mouseenter",()=>{n.classList.add("hover")}),e.addEventListener("mouseleave",()=>{n.classList.remove("hover")})}(n,s);break;case"cssSelector":n.classList.add("link"),n.addEventListener("click",()=>{chrome.devtools.inspectedWindow.eval(`inspect(document.querySelector('${s}'));`)});break;case"schemaName":n.classList.add("link"),n.addEventListener("click",()=>{chrome.tabs.create({url:`https://github.com/amedia/adplogger2/tree/master/packages/schemas/docs/${s}.md`})});break;case"id":n.setAttribute("id",s)}return n}function i(e,t,n=""){t.insertAdjacentHTML("beforeend",n);const s=document.createElement("dl");Object.keys(e).forEach(t=>{"element"!==t&&("object"!=typeof e[t]?(s.insertAdjacentHTML("beforeend",`<dt>${t}</dt>`),s.appendChild(d(t,e))):i(e[t],s,`<h2>${t}</h2>`))}),t.appendChild(s)}class o extends HTMLElement{constructor(){super(),this.currentElementName="",this.currentElement=null,this.metaEvents=new Map,this.events=new Set,a(e=>{"show-events-from-elements"===e.type&&this.showEventsMatchingSelectors(e.value)})}showEventsMatchingSelectors(e){const t=[...this.metaEvents.values()],n=t.map(e=>e.payload.cssSelector);let s;e.every(e=>{const a=n.indexOf(e);return-1===a||(s=t[a],!1)}),s&&(this.details.innerHTML="",i(s,this.details,`<h1>${s.schemaName}</h1>`),[...this.events].filter(e=>s.payload.id===e.payload.concernsMeta).forEach(e=>i(e,this.details,`<h1>${e.schemaName}</h1>`)))}connectedCallback(){this.details=document.createElement("div"),this.details.classList.add("details"),this.parentNode.appendChild(this.details)}disconnectedCallback(){this.details.parentNode.removeChild(this.details)}highlight(e){const t=this.metaEvents.get(e.payload.concernsMeta);t&&t.payload.cssSelector&&s({action:"overlay",value:t.payload.cssSelector})}reset(){this.insertBefore(document.createElement("amedia-pagenav"),this.firstChild),this.metaEvents=new Map,this.events=new Set}add(e){const{schemaName:t}=e;t!==this.currentElementName&&(this.currentElement=document.createElement("div"),this.currentElement.classList.add(t),this.currentElement.insertAdjacentHTML("afterbegin",`<strong>${t}</strong>`),this.insertBefore(this.currentElement,this.firstChild),this.currentElementName=t);const n=document.createElement("span");n.title=function e(t,n=""){let s=n+"\n";return Object.keys(t).forEach(n=>{"element"!==n&&("object"!=typeof t[n]?s=s+n+" : "+t[n]+"\n":s+=e(t[n],n))}),s}(e,e.schemaName),e.payload.id?(this.metaEvents.set(e.payload.id,{...e,element:n}),n.setAttribute("id",e.payload.id)):this.events.add(e),n.addEventListener("click",()=>{this.details.innerHTML="",i(e,this.details,`<h1>${e.schemaName}</h1>`),e.payload.concernsMeta&&this.highlight(e)}),this.currentElement.appendChild(n)}}customElements.define("amedia-event-list",o)},function(e,t,n){"use strict";n.r(t),n.d(t,"addListener",(function(){return i})),n.d(t,"sendMessage",(function(){return c}));const s=chrome.devtools.network,a=chrome.runtime.connect({name:"adplogger v2"});a.postMessage({name:"init",tabId:chrome.devtools.inspectedWindow.tabId});const d=new Set;function i(e){d.add(e)}function o(){a.postMessage({name:"add-files",tabId:chrome.devtools.inspectedWindow.tabId})}function c(e){a.postMessage({type:"adplogger-content",tabId:chrome.devtools.inspectedWindow.tabId,...e})}a.onMessage.addListener(e=>{d.forEach(t=>t(e))}),s.onNavigated.addListener(o),o()}]);